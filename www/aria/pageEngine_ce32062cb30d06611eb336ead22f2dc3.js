/*
 * Copyright Amadeus
 */
//***MULTI-PART
//MCylagYg2Y
//LOGICAL-PATH:aria/pageEngine/CfgBeans.js
//MCylagYg2Y
Aria.beanDefinitions({$package:"aria.pageEngine.CfgBeans",$description:"Definition of the beans used in aria.pageEngine",$namespaces:{json:"aria.core.JsonTypes",core:"aria.core.CfgBeans"},$beans:{ExtendedCallback:{$type:"json:Object",$description:"Contains a callback for success and a callback for failure.",$properties:{onsuccess:{$type:"core:Callback",$description:"Callback to be called in case of success."},onfailure:{$type:"core:Callback",$description:"Callback to be called in case of failure."}}},
Start:{$type:"json:Object",$description:"Configuration object for the Page Engine's start method.",$properties:{pageProvder:{$type:"json:Object",$description:"Instance of class that implements aria.pageEngine.pageProviders.PageProviderInterface.",$mandatory:true},onerror:{$type:"core:Callback",$description:"Callback in case of error while starting the Page Engine."},oncomplete:{$type:"core:Callback",$description:"Callback for the correct start of the Page Engine."}}},Site:{$type:"json:Object",$description:"Site configuration.",
$properties:{containerId:{$type:"json:String",$description:"Id of the HTML element inside which the application will be loaded.",$mandatory:true},commonModules:{$type:"json:Map",$description:"Map containing the common modules to load",$contentType:{$type:"CommonModule",$description:"Common module description."},$default:{}},appData:{$type:"json:Map",$description:"Application data that will be available in the data model of the page engine, for example a menu.",$contentType:{$type:"json:MultiTypes",
$description:"Any kind of value."},$default:{}},contentProcessors:{$type:"json:Map",$description:"Classes that handle different content types",$contentType:{$type:"json:PackageName",$description:"Classpath of the class that is able to preprocess the content type specified in the key."},$default:{}},navigation:{$type:"json:Enum",$description:"Type of navigation from page to page",$enumValues:["history","hash"]}}},PageRequest:{$type:"json:Object",$description:"Object accepted by the navigation method",
$properties:{pageId:{$type:"json:String",$description:"Identifier of the page."},url:{$type:"json:String",$description:"Part of the url that should be appended to the domain."}}},PageNavigationInformation:{$type:"PageRequest",$description:"Information that is given to the history manager",$properties:{replace:{$type:"json:Boolean",$description:"Whether to replace or push the state. Only valid when the navigation type has been set to history in the site configuration."},title:{$type:"json:String",
$description:"Title of the page. Only valid when the navigation type has been set to history in the site configuration."},data:{$type:"json:Object",$description:"State information to be saved. Only valid when the navigation type has been set to history in the site configuration."}}},PageDefinition:{$type:"json:Object",$description:"Defintion of a page required by the application manager.",$properties:{contents:{$type:"PageContents",$description:"Contents for the current page",$mandatory:true},pageComposition:{$type:"PageComposition",
$description:"Page composition",$mandatory:true},pageId:{$type:"json:String",$description:"Identifier of the page.",$mandatory:true},url:{$type:"json:String",$description:"Part of the url that should be appended to the domain."},title:{$type:"json:String",$description:"Title of the page. Only used when the navigation type has been set to history in the site configuration."}}},PageContents:{$type:"json:Object",$description:"Menus and HTML contents of a page.",$properties:{menus:{$type:"json:Map",$description:"List of menus descriptions",
$keyType:{$type:"json:String",$description:"Id of the menu"},$contentType:{$type:"json:Object",$description:"Single menu description",$restricted:false}},placeholderContents:{$type:"json:Map",$description:"Contents to be added in the placeholders",$keyType:{$type:"json:String",$description:"ContentId's that are present in the pageComposition"},$contentType:{$type:"Content"}}}},PageComposition:{$type:"json:Object",$description:"Defintion of a page layout required by the application manager.",$properties:{template:{$type:"json:String",
$description:"Template classpath used by the page.",$mandatory:true},pageData:{$type:"json:Object",$description:"data to be used by the page (removed when the page change).",$restricted:false,$default:{}},modules:{$type:"json:Map",$description:"List of modules that are local to the page.",$contentType:{$type:"Module",$description:"Description of each module."},$default:{}},placeholders:{$type:"json:Map",$description:"List of the placeholders that can be displayed on the page.",$keyType:{$type:"json:String",
$description:"path of the placeholder.",$sample:"body.top"},$contentType:{$type:"Placeholder"},$mandatory:true}}},Placeholder:{$type:"json:MultiTypes",$description:"Description of a placeholder.",$contentTypes:[{$type:"json:String",$description:"Html content"},{$type:"json:Object",$description:"Contains the template classpath, and the moduleId (optional) inn order to retrieve the module controller",$properties:{template:{$type:"json:String",$description:"template classpath"},contentId:{$type:"json:String",
$description:"Id that is used to retrive the html content in the global content definition. If a template is present, the retrieved contents will be provided as last arguments of the main macro of the template"},module:{$type:"json:String",$description:"Id of the module controller that is used as a key inside the module map of the page definition. If prefixed by the 'common:', then the module "},data:{$type:"json:Object",$description:"Data model of the template. This is an alternative to the module property, as templates with a module controller inherit its data model."},
args:{$type:"json:Array",$description:"Arguments to be passed t the main macro of the template. If a contentId is specified, the retrieved content will be automatically added to the arguments.",$contentType:{$type:"json:MultiTypes",$description:"Anything."}}}},{$type:"json:Array",$contentType:{$type:"Placeholder"},$description:"List of pieces of contents to be displayed."}]},Module:{$type:"json:Object",$description:"Description of the module that is created at page level.",$properties:{classpath:{$type:"json:PackageName",
$description:"Classpath of the module controller.",$mandatory:true},initArgs:{$type:"json:ObjectRef",$description:"Arguments to pass to the init method of the module controller."},bind:{$type:"json:ObjectRef",$description:"List of data bindings. The key is a location in the module's data model, the value is inside the site module controller and has the form 'location:path' like 'appData:search.from'"}}},CommonModule:{$type:"Module",$description:"Common module.",$properties:{priority:{$type:"json:Integer",
$description:"If it is equal to 1, the submodule is loaded in the application initialization. If it is equal to 2, it is loaded when required by a page.",$default:1,$minValue:1,$maxValue:2}}},Content:{$type:"json:Object",$description:"Description of a piece of content.",$properties:{value:{$type:"json:String",$description:"Content to be displayed.",$mandatory:true},contentType:{$type:"json:String",$description:"Type of the content."}}}}});
//MCylagYg2Y
//LOGICAL-PATH:aria/pageEngine/PageEngine.js
//MCylagYg2Y
Aria.classDefinition({$classpath:"aria.pageEngine.PageEngine",$implements:["aria.embed.IContentProvider","aria.pageEngine.PageEngineInterface"],$dependencies:["aria.pageEngine.CfgBeans","aria.pageEngine.SiteRootModule","aria.templates.ModuleCtrlFactory","aria.core.JsonValidator","aria.pageEngine.utils.SiteConfigHelper","aria.pageEngine.utils.PageConfigHelper","aria.embed.PlaceholderManager","aria.utils.Type","aria.pageEngine.utils.PageEngineUtils"],$constructor:function(){this._rootModule=this._siteConfigHelper=
this._navigationManager=this._pageProvider=this._config=null;this._pageConfigs={};this.contentProcessors={};this.currentPageId=this._dependenciesLoader=null;this._utils=aria.pageEngine.utils.PageEngineUtils;this._wrapper=this.$interface("aria.pageEngine.PageEngineInterface");this._isTemplateLoaded=false},$destructor:function(){aria.embed.PlaceholderManager.unregister(this);this._navigationManager&&this._navigationManager.$dispose();if(this._isTemplateLoaded){Aria.disposeTemplate(this._siteConfigHelper.getRootDiv());
this._siteConfigHelper.$dispose()}this._rootModule&&this._rootModule.$dispose()},$statics:{SITE_CONFIG_NOT_AVAILABLE:"Unable to retrieve the site configuration",INVALID_SITE_CONFIGURATION:"The configuration object of the application is not valid",PAGE_NOT_AVAILABLE:"Unable to retrieve page %1",INVALID_PAGE_DEFINITION:"The page definition does not match the bean aria.pageEngine.CfgBeans.PageDefinition",MISSING_DEPENDENCIES:"Unable to download Page Engine dependencies"},$prototype:{start:function(a){this._config=
a;this._pageProvider=a.pageProvider;aria.embed.PlaceholderManager.register(this);this._pageProvider.loadSiteConfig({onsuccess:{fn:this._loadRootModule,scope:this},onfailure:{fn:this._errorCallback,scope:this,args:[this.SITE_CONFIG_NOT_AVAILABLE],resIndex:-1}})},_loadRootModule:function(a){if(this.isConfigValid(a,"aria.pageEngine.CfgBeans.Site",this.INVALID_SITE_CONFIGURATION)){this._siteConfigHelper=a=new aria.pageEngine.utils.SiteConfigHelper(a);var b=a.getAppData();b.menus=b.menus||{};aria.templates.ModuleCtrlFactory.createModuleCtrl({classpath:"aria.pageEngine.SiteRootModule",
initArgs:{appData:a.getAppData(),pageEngine:this._wrapper}},{fn:this._loadSiteDependencies,scope:this})}},_loadSiteDependencies:function(a){this._rootModule=a.moduleCtrlPrivate;a=this._siteConfigHelper.getListOfContentProcessors();var b=this._siteConfigHelper.getNavigationManagerClass();b&&a.push(b);b=this._siteConfigHelper.getCommonModulesDescription({priority:1});this._utils.wiseConcat(a,this._utils.extractPropertyFromArrayElements(b,"classpath"));Aria.load({classes:a,oncomplete:{fn:this._loadGlobalModules,
scope:this,args:b},onerror:{fn:this._errorCallback,scope:this,args:[this.MISSING_DEPENDENCIES],resIndex:-1}})},_loadGlobalModules:function(a){this._rootModule.loadModules(null,{page:[],common:a},{fn:this._onSiteReady,scope:this})},_onSiteReady:function(){this.contentProcessors=this._siteConfigHelper.getContentProcessorInstances();this._navigationManager=this._siteConfigHelper.getNavigationManager({fn:"navigate",scope:this});this.navigate({url:this._navigationManager?this._navigationManager.getUrl():
null,pageId:this._navigationManager?this._navigationManager.getPageId():null,replace:true},this._config.oncomplete)},navigate:function(a,b){var c=a.pageId;if(c&&c==this.currentPageId){this.$callback(b);this._navigationManager&&this._navigationManager.update(a)}else this._pageProvider.loadPageDefinition(a,{onsuccess:{fn:this._getPageDependencies,scope:this,args:{pageRequest:a,cb:b}},onfailure:{fn:this._errorCallback,scope:this,args:[this.PAGE_NOT_AVAILABLE,c],resIndex:-1}})},_getPageDependencies:function(a,
b){if(this.isConfigValid(a,"aria.pageEngine.CfgBeans.PageDefinition",this.INVALID_PAGE_DEFINITION)){var c=new aria.pageEngine.utils.PageConfigHelper(a);aria.utils.Json.inject(c.getMenus(),this._siteConfigHelper.getAppData().menus);this._pageConfigHelper=c;this._lazyContent=true;this._loadPageDependencies({lazy:false,pageId:a.pageId,cb:{fn:this._displayPage,scope:this,args:{cb:b.cb,pageConfig:a,pageRequest:b.pageRequest}}})}else this.$callback(b.cb)},_loadPageDependencies:function(a){var b=this._pageConfigHelper.getPageDependencies(a.lazy),
c=this._siteConfigHelper.getCommonModulesDescription({priority:2,refpaths:b.modules.common});this._utils.wiseConcat(b.classes,this._utils.extractPropertyFromArrayElements(c,"classpath"));var d=this._pageConfigHelper.getPageModulesDescriptions(b.modules.page);b.oncomplete={scope:this,fn:this._loadPageModules,args:{pageId:a.pageId,cb:a.cb,subModules:{common:c,page:d}}};b.onerror={fn:this._errorCallback,scope:this,args:[this.MISSING_DEPENDENCIES],resIndex:-1};Aria.load(b)},_loadPageModules:function(a){this._rootModule.loadModules(a.pageId,
a.subModules,a.cb)},isConfigValid:function(a,b,c){try{aria.core.JsonValidator.normalize({json:a,beanName:b},true)}catch(d){this._utils.logMultipleErrors(c,d.errors,this);this._config.onerror&&this.$callback(this._config.onerror,c);return false}return true},_displayPage:function(a){var b=a.pageConfig.pageComposition,c=a.pageConfig.pageId;this.currentPageId=c;this._pageConfigs[c]=a.pageConfig;var d=a.pageRequest;d.url=a.pageConfig.url;d.pageId=a.pageConfig.pageId;d.title=a.pageConfig.title;this._navigationManager&&
this._navigationManager.update(d);d=this._siteConfigHelper.getRootDiv();b.pageData&&this._rootModule.setPageData(b.pageData,c);b={classpath:b.template,div:d,moduleCtrl:this._rootModule,args:[{pageCfg:b}]};if(this._isTemplateLoaded){Aria.disposeTemplate(d);this._isTemplateLoaded=false}Aria.loadTemplate(b);this._isTemplateLoaded=true;this.$raiseEvent({name:"pageReady",pageId:c});a.cb&&this.$callback(a.cb);this._loadPageDependencies({lazy:true,pageId:c,cb:{fn:this._afterLazyDependenciesLoad,scope:this}})},
_afterLazyDependenciesLoad:function(){var a=this._pageConfigHelper.getLazyPlaceholdersIds();this._lazyContent=false;this.$raiseEvent({name:"contentChange",contentPaths:a});this._pageConfigHelper.$dispose()},getContent:function(a){var b=aria.utils.Type,c=this._pageConfigs[this.currentPageId];a=c.pageComposition.placeholders[a]||[];var d=[],e;b.isArray(a)||(a=[a]);for(var f=0,g=a.length;f<g;f++){e=a[f];if(b.isObject(e))if(this._lazyContent&&e.lazy)d.push({loading:true,width:e.lazy.width||null,height:e.lazy.height||
null,color:e.lazy.color||null,innerHTML:e.lazy.innerHTML||null});else if(e.template)d.push(this._getTemplateCfg(e,c));else{if(e.contentId){e=this._getPlaceholderContents(c,e.contentId);d=d.concat(e)}}else d.push(e)}return d},_getTemplateCfg:function(a,b){var c={classpath:a.template},d=a.args||[],e={};if(a.contentId)e.contents=this._getPlaceholderContents(b,a.contentId);d.push(e);c.args=d;if(a.module)c.moduleCtrl=this._rootModule.getPageModule(this.currentPageId,a.module);return c},_getPlaceholderContents:function(a,
b){var c=[],d=a.contents.placeholderContents[b];if(!d)return c;aria.utils.Type.isArray(d)||(d=[d]);for(var e=0,f=d.length;e<f;e++)c=c.concat(this.processContent(d[e]));return c},processContent:function(a){var b=a.contentType;if(b&&b in this.contentProcessors)return this.processContent(this.contentProcessors[b].processContent(a));return a.value||""},_errorCallback:function(a){var b=this._config;this.$logError.apply(this,a);b.onerror&&this.$callback(b.onerror,a[0])}}});
//MCylagYg2Y
//LOGICAL-PATH:aria/pageEngine/PageEngineInterface.js
//MCylagYg2Y
Aria.interfaceDefinition({$classpath:"aria.pageEngine.PageEngineInterface",$events:{pageReady:{description:"Raised when the page has been displayed",properties:{pageId:"Identifier of the page."}}},$interface:{navigate:{$type:"Function",$callbackParam:1}}});
//MCylagYg2Y
//LOGICAL-PATH:aria/pageEngine/SiteRootModule.js
//MCylagYg2Y
Aria.classDefinition({$classpath:"aria.pageEngine.SiteRootModule",$extends:"aria.templates.ModuleCtrl",$implements:["aria.pageEngine.SiteRootModuleInterface"],$dependencies:["aria.utils.Path","aria.pageEngine.utils.PageEngineUtils"],$constructor:function(){this._enableMethodEvents=false;this.$ModuleCtrl.constructor.call(this);this.commonModules={};this.pageModules={};this._modulesPaths={common:[],page:{}};this._utils=aria.pageEngine.utils.PageEngineUtils;this._pathUtils=aria.utils.Path;this._bindings=
{};this._pageEngine=null},$destructor:function(){this.json.removeListener(this._data,"storage",{fn:this._updateModulesData,scope:this},true);this.unloadAllModules();this.pageModules=this.commonModules=this._data=null;this.$ModuleCtrl.$destructor.call(this)},$prototype:{$publicInterfaceName:"aria.pageEngine.SiteRootModuleInterface",init:function(a,b){this._data={storage:{appData:a.appData,pageData:{}}};this.json.addListener(this._data,"storage",{fn:this._updateModulesData,scope:this},false,true);this._pageEngine=
a.pageEngine;this.$callback(b)},setPageData:function(a,b){this.json.setValue(this._data.storage,"pageId",b);this.json.setValue(this._data.storage,"pageData",a)},onSubModuleEvent:function(a){a.name=="navigate"&&this._pageEngine.navigate(a.page)},navigate:function(a){this._pageEngine.navigate(a)},getPageModule:function(a,b){var c=b.indexOf("common:")!=-1;return this._utils.resolvePath(this.buildModuleRefpath(b.replace(/^common:/,""),c,a),this)},buildModuleRefpath:function(a,b,c){if(b)return"commonModules."+
a;return"pageModules."+c+"."+a},loadModules:function(a,b,c){for(var d=[],f=[],e,h,g,k=[{modules:b.page,isCommon:false},{modules:b.common,isCommon:true}],i=0;i<2;i++){b=k[i].modules;h=k[i].isCommon;for(var j=0,l=b.length;j<l;j+=1){e=this.buildModuleRefpath(b[j].refpath,h,a);if(this._utils.resolvePath(e,this)==null){g=aria.utils.Json.copy(b[j]);g.refpath=e;d.push({classpath:g.classpath,initArgs:g.initArgs,refpath:e});f.push(g);this._addRefpath(a,h,e)}}}this.loadSubModules(d,{fn:this.connectBindings,
scope:this,resIndex:-1,args:{pageId:a,callback:c,modules:f}})},_unloadModules:function(a){for(var b,c=0,d=a.length;c<d;c++){b=a[c];this._disconnectModuleBindings(b);this.disposeSubModule(this._utils.resolvePath(b,this))}},unloadCommonModules:function(){this._unloadModules(this._modulesPaths.common||[]);this._modulesPaths.common=[]},unloadPageModules:function(a){this._unloadModules(a&&this._modulesPaths.page[a]?this._modulesPaths.page[a]:[]);delete this._modulesPaths.page[a]},unloadAllModules:function(){this.unloadCommonModules();
var a=this._modulesPaths.page,b;for(b in a)a.hasOwnProperty(b)&&this.unloadPageModules(b)},_addRefpath:function(a,b,c){var d=this._modulesPaths;if(b)d.common.push(c);else{d.page[a]=d.page[a]||[];d.page[a].push(c)}},connectBindings:function(a){for(var b=a.modules,c=0;c<b.length;c+=1){var d=b[c].bind,f=b[c].refpath;if(d)for(var e in d)if(d.hasOwnProperty(e)){var h=this._getStorage(d[e]);if(h){var g=this._getModuleDataDescription(f,e);this.$assert(2,!!g);h={fn:this._bindModuleChange,scope:this,args:{boundTo:h,
moduleDescription:g}};this.json.addListener(g.container,g.property,h,false,true);this._bindings[f]=this._bindings[f]||{};this._bindings[f][e]=[d[e],h]}}}this._updateModulesData();this.$callback(a.callback,a.callback.args)},disconnectBindings:function(a){if(a)for(var b=0,c=a.length;b<c;b++)this._disconnectModuleBindings(a[b]);else{this.disconnectBindings(this._modulesPaths.common);a=this._modulesPaths.page;for(b in a)a.hasOwnProperty(b)&&this.disconnectBindings(a[b])}},_disconnectModuleBindings:function(a){var b=
this._bindings[a];if(b){for(var c in b)if(b.hasOwnProperty(c)){var d=this._getModuleDataDescription(a,c);this.json.removeListener(d.container,d.property,b[c][1],true)}delete this._bindings[a]}},_updateModulesData:function(){var a=this._bindings,b;for(b in a)if(a.hasOwnProperty(b)){var c=a[b],d;for(d in c)if(c.hasOwnProperty(d)){var f=this._getModuleDataDescription(b,d),e=this._getStorage(c[d][0]);e=this._utils.resolvePath(e.path,e.storage);this.json.setValue(f.container,f.property,e,c[d][1])}}},_getModuleDataDescription:function(a,
b){var c=this._utils.resolvePath(a,this._data);this._utils.resolvePath(b,c)||this._pathUtils.setValue(c,b,null);return this._pathUtils.describe(c,b)},_getStorage:function(a){a=a.split(":");if(a.length<2)return null;var b=this._data.storage[a[0]];if(!b)return null;a.splice(0,1);return{storage:b,path:a.join(":")}},_bindModuleChange:function(a,b){var c=b.moduleDescription.container[b.moduleDescription.property],d=b.boundTo;this._utils.resolvePath(d.path,d.storage)==null&&this._pathUtils.setValue(d.storage,
d.path,null);d=this._pathUtils.describe(d.storage,d.path);this.json.setValue(d.container,d.property,c)}}});
//MCylagYg2Y
//LOGICAL-PATH:aria/pageEngine/SiteRootModuleInterface.js
//MCylagYg2Y
Aria.interfaceDefinition({$classpath:"aria.pageEngine.SiteRootModuleInterface",$extends:"aria.templates.IModuleCtrl",$events:{pageReady:"Raised when the page is ready to be displayed."},$interface:{getPageModule:{$type:"Function"},loadModules:{$type:"Function",$callbackParam:2},unloadCommonModules:{$type:"Function"},unloadPageModules:{$type:"Function"},unloadAllModules:{$type:"Function"},navigate:{$type:"Function"}}});
//MCylagYg2Y
//LOGICAL-PATH:aria/pageEngine/utils/PageConfigHelper.js
//MCylagYg2Y
Aria.classDefinition({$classpath:"aria.pageEngine.utils.PageConfigHelper",$dependencies:["aria.pageEngine.utils.PageEngineUtils","aria.utils.Type","aria.utils.Array"],$constructor:function(b){this._pageConfig=b;this._utils=aria.pageEngine.utils.PageEngineUtils;this._utils.addKeyAsProperty(this._pageConfig.pageComposition.modules,"refpath")},$prototype:{getMenus:function(){return this._pageConfig.contents.menus},getPageDependencies:function(b){var d={templates:[],classes:[],modules:{page:[],common:[]}},
a=this._pageConfig.pageComposition,c=a.placeholders||{},e=aria.utils.Type;b||this._utils.addIfMissing(a.template,d.templates);for(var f in c)if(c.hasOwnProperty(f)){a=c[f];e.isArray(a)||(a=[a]);for(var g=0;g<a.length;g+=1)this._addPlaceholderDependencies(a[g],d,b)}return d},_addPlaceholderDependencies:function(b,d,a){var c=this._pageConfig.pageComposition.modules||{};if(aria.utils.Type.isObject(b)){var e=b.lazy;if(!(a&&!e||!a&&e)){if("module"in b){a=b.module;if(a.match(/^common:/))this._utils.addIfMissing(a.replace(/^common:/,
""),d.modules.common);else if(c=c[a]){this._utils.addIfMissing(c.classpath,d.classes);this._utils.addIfMissing(a,d.modules.page)}}"template"in b&&this._utils.addIfMissing(b.template,d.templates)}}},getPageModulesDescriptions:function(b){var d=this._pageConfig.pageComposition.modules||{},a=[],c,e,f;if(b){c=0;for(e=b.length;c<e;c++)(f=d[b[c]])&&a.push(f);return a}return aria.utils.Array.extractValuesFromMap(d)},getLazyPlaceholdersIds:function(){var b=[],d,a=aria.utils.Type,c=this._pageConfig.pageComposition.placeholders||
{},e;for(e in c)if(c.hasOwnProperty(e)){d=false;var f=c[e];a.isArray(f)||(f=[f]);for(var g=0;g<f.length;g+=1)if(f[g].lazy)d=true;d&&b.push(e)}return b}}});
//MCylagYg2Y
//LOGICAL-PATH:aria/pageEngine/utils/PageEngineUtils.js
//MCylagYg2Y
Aria.classDefinition({$classpath:"aria.pageEngine.utils.PageEngineUtils",$singleton:true,$dependencies:["aria.utils.Array","aria.utils.Path"],$prototype:{addIfMissing:function(a,c){a&&!aria.utils.Array.contains(c,a)&&c.push(a)},wiseConcat:function(a,c){for(var b,d=0,e=c.length;d<e;d++){b=c[d];this.addIfMissing(b,a)}},extractPropertyFromArrayElements:function(a,c){for(var b=[],d,e=0,f=a.length;e<f;e++){d=a[e];d[c]&&b.push(d[c])}return b},addKeyAsProperty:function(a,c){for(var b in a)if(a.hasOwnProperty(b))a[b][c]=
b},resolvePath:function(a,c){var b;try{b=aria.utils.Path.resolve(a,c)}catch(d){b=undefined}return b},logMultipleErrors:function(a,c,b){b.$logError.apply(b,[a+":"]);a=0;for(var d=c.length;a<d;a++)b.$logError.apply(b,[a+1+" - "+c[a].msgId,c[a].msgArgs])}}});
//MCylagYg2Y
//LOGICAL-PATH:aria/pageEngine/utils/SiteConfigHelper.js
//MCylagYg2Y
Aria.classDefinition({$classpath:"aria.pageEngine.utils.SiteConfigHelper",$dependencies:["aria.utils.Dom","aria.pageEngine.utils.PageEngineUtils","aria.utils.Array"],$constructor:function(a){this._siteConfig=a;this._contentProcessorsInstances={};aria.pageEngine.utils.PageEngineUtils.addKeyAsProperty(this._siteConfig.commonModules,"refpath")},$destructor:function(){this.disposeContentProcessorsInstances()},$statics:{MISSING_PROCESS_METHOD:"The processContent method is not implemented"},$prototype:{getRootDiv:function(){var a=
this.getRootDivId(),b=aria.utils.Dom.getElementById(a);if(!b){b=Aria.$window.document.createElement("DIV");b.id=a;Aria.$window.document.body.appendChild(b)}return b},getRootDivId:function(){return this._siteConfig.containerId},getAppData:function(){return this._siteConfig.appData},getListOfContentProcessors:function(){var a=[],b;for(b in this._siteConfig.contentProcessors)this._siteConfig.contentProcessors.hasOwnProperty(b)&&a.push(this._siteConfig.contentProcessors[b]);return a},getContentProcessorInstances:function(){var a=
{},b=aria.utils.Type,c;for(c in this._siteConfig.contentProcessors)if(this._siteConfig.contentProcessors.hasOwnProperty(c)){var d=Aria.getClassRef(this._siteConfig.contentProcessors[c]);d=b.isFunction(d)?new d:d;if(d.processContent)a[c]=d;else this.$logError(this.MISSING_PROCESS_METHOD,this._siteConfig.contentProcessors[c])}return this._contentProcessorsInstances=a},disposeContentProcessorsInstances:function(){var a=aria.utils.Type,b=this._contentProcessorsInstances,c;for(c in b)if(b.hasOwnProperty(c)){var d=
Aria.getClassRef(this._siteConfig.contentProcessors[c]);a.isFunction(d)&&b[c].$dispose()}},getCommonModulesDescription:function(a){var b=this._siteConfig.commonModules;if(!a)return aria.utils.Array.extractValuesFromMap(b);var c=a.priority;a=a.refpaths;var d=[],e;if(a){for(var f=0,g=a.length;f<g;f++)if((e=b[a[f]])&&(!c||c==e.priority))d.push(e);return d}for(f in b)if(b.hasOwnProperty(f)){e=b[f];if(!c||c==e.priority)d.push(e)}return d},getNavigationManagerClass:function(){var a=this._siteConfig.navigation;
if(a){if(a=="history")return"aria.pageEngine.utils.HistoryManager";if(a=="hash")return"aria.pageEngine.utils.HashManager"}return null},getNavigationManager:function(a){var b=this._siteConfig.navigation;if(b){if(b=="history")return new aria.pageEngine.utils.HistoryManager(a);if(b=="hash")return new aria.pageEngine.utils.HashManager(a)}return null}}});